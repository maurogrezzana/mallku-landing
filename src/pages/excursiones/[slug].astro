---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import WhatsAppFloat from '../../components/WhatsAppFloat.astro';
import { excursiones, type Excursion } from '../../data/excursiones';

export function getStaticPaths() {
  return excursiones.map((excursion) => ({
    params: { slug: excursion.slug },
    props: { excursion }
  }));
}

interface Props {
  excursion: Excursion;
}

const { excursion } = Astro.props;
---

<BaseLayout
  title={excursion.titulo}
  description={excursion.descripcion}
>
  <WhatsAppFloat />
  <Header />

  <main>
    <!-- HERO -->
    <section class="hero-excursion" style={`background-image: linear-gradient(to bottom, rgba(6,27,56,0.5), rgba(6,27,56,0.8)), url('${excursion.imagen}');`}>
      <div class="wrap">
        <span class="tag">{excursion.tag}</span>
        <h1>{excursion.titulo}</h1>
        <p class="subtitulo">{excursion.subtitulo}</p>

        <div class="hero-meta">
          <div class="meta-item">
            <span class="meta-icon">‚è±Ô∏è</span>
            <div>
              <strong>Duraci√≥n</strong>
              <span>{excursion.duracion}</span>
            </div>
          </div>
          <div class="meta-item">
            <span class="meta-icon">üöÄ</span>
            <div>
              <strong>Salida</strong>
              <span>{excursion.salida}</span>
            </div>
          </div>
          <div class="meta-item">
            <span class="meta-icon">üìä</span>
            <div>
              <strong>Dificultad</strong>
              <span>{excursion.dificultad}</span>
            </div>
          </div>
          <div class="meta-item">
            <span class="meta-icon">üë•</span>
            <div>
              <strong>Grupo m√°ximo</strong>
              <span>{excursion.grupoMax}</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- DESCRIPCI√ìN -->
    <section class="section section-light">
      <div class="wrap">
        <div class="content-layout">
          <div class="content-main">
            <h2>Sobre esta excursi√≥n</h2>
            {excursion.descripcionLarga.map((parrafo) => (
              <p>{parrafo}</p>
            ))}

            <h3>Puntos destacados</h3>
            <ul class="highlights">
              {excursion.highlights.map((item) => (
                <li>{item}</li>
              ))}
            </ul>
          </div>

          <aside class="content-sidebar">
            <div class="price-card">
              <div class="price-header">
                <span class="price-label">Precio por persona</span>
                <span class="price-valor">{excursion.precio}</span>
                <span class="price-note">{excursion.priceNote}</span>
              </div>
              <a class="btn btn-primary btn-full" href={excursion.whatsappLink} target="_blank" rel="noopener">
                Reservar ahora
              </a>
              <p class="price-info">Consult√° fechas disponibles y asegur√° tu lugar</p>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <!-- GALER√çA DE FOTOS -->
    <section class="section section-dark">
      <div class="wrap">
        <h2 class="section-title text-center">Fotos de la excursi√≥n</h2>
        <div class="fotos-grid">
          {excursion.imagenes.slice(0, 8).map((img, i) => (
            <div class={`foto-item ${i === 0 ? 'foto-grande' : ''}`}>
              <img src={img} alt={`${excursion.titulo} - foto ${i + 1}`} loading="lazy" />
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- ITINERARIO -->
    <section class="section section-dark" style="padding-top: 0;">
      <div class="wrap">
        <h2 class="section-title text-center">Itinerario del d√≠a</h2>
        <div class="itinerario">
          {excursion.itinerario.map((item, index) => (
            <div class="itinerario-item">
              <div class="itinerario-hora">{item.hora}</div>
              <div class="itinerario-linea">
                <div class="itinerario-punto"></div>
                {index < excursion.itinerario.length - 1 && <div class="itinerario-connector"></div>}
              </div>
              <div class="itinerario-content">
                <h4>{item.actividad}</h4>
                <p>{item.descripcion}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- INCLUYE / NO INCLUYE -->
    <section class="section section-light">
      <div class="wrap">
        <div class="incluye-grid">
          <div class="incluye-card">
            <h3>‚úÖ ¬øQu√© incluye?</h3>
            <ul>
              {excursion.incluye.map((item) => (
                <li>{item}</li>
              ))}
            </ul>
          </div>
          <div class="incluye-card no-incluye">
            <h3>‚ùå No incluye</h3>
            <ul>
              {excursion.noIncluye.map((item) => (
                <li>{item}</li>
              ))}
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- RECOMENDACIONES -->
    <section class="section section-terracota">
      <div class="wrap">
        <h2 class="section-title text-center">Recomendaciones</h2>
        <p class="section-subtitle text-center" style="color: rgba(255,255,255,0.85);">Para disfrutar al m√°ximo tu experiencia</p>
        <div class="recomendaciones-grid">
          {excursion.recomendaciones.map((rec) => (
            <div class="recomendacion-item">
              <span>üëâ</span>
              <p>{rec}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- CTA FINAL -->
    <section class="section section-dark">
      <div class="wrap text-center">
        <h2 class="section-title">¬øListo para vivir esta experiencia?</h2>
        <p class="section-subtitle">Escribinos por WhatsApp y reserv√° tu lugar en la pr√≥xima salida.</p>
        <a class="btn btn-primary" href={excursion.whatsappLink} target="_blank" rel="noopener">
          Consultar disponibilidad
        </a>
        <p style="margin-top: var(--space-md); opacity: 0.6; font-size: 14px;">
          <a href="/excursiones" style="color: var(--color-primary);">‚Üê Ver todas las excursiones</a>
        </p>
      </div>
    </section>
  </main>

  <Footer />
</BaseLayout>

<style>
  /* Hero Excursion */
  .hero-excursion {
    padding: 80px 0 60px;
    background-size: cover;
    background-position: center;
  }

  .tag {
    display: inline-block;
    padding: 8px 16px;
    background: var(--color-primary);
    color: #fff;
    font-family: var(--font-display);
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
    border-radius: 6px;
    margin-bottom: var(--space-md);
  }

  .hero-excursion h1 {
    margin: 0 0 var(--space-xs);
    font-size: clamp(36px, 5vw, 52px);
  }

  .subtitulo {
    font-size: 20px;
    color: var(--color-primary);
    margin: 0 0 var(--space-xl);
  }

  .hero-meta {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-lg);
    padding: var(--space-lg);
    background: rgba(239, 227, 214, 0.08);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-line-light);
  }

  .meta-item {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
  }

  .meta-icon {
    font-size: 24px;
  }

  .meta-item strong {
    display: block;
    font-family: var(--font-display);
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: rgba(239, 227, 214, 0.6);
  }

  .meta-item span:not(.meta-icon) {
    font-size: 15px;
  }

  /* Fotos Grid */
  .fotos-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--space-sm);
    margin-top: var(--space-xl);
  }

  .foto-item {
    border-radius: var(--radius-md);
    overflow: hidden;
    aspect-ratio: 4/3;
  }

  .foto-item.foto-grande {
    grid-column: span 2;
    grid-row: span 2;
    aspect-ratio: auto;
  }

  .foto-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.4s ease;
    cursor: pointer;
  }

  .foto-item:hover img {
    transform: scale(1.05);
  }

  @media (max-width: 600px) {
    .fotos-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .foto-item.foto-grande {
      grid-column: span 2;
      grid-row: span 1;
      aspect-ratio: 16/9;
    }
  }

  /* Content Layout */
  .content-layout {
    display: grid;
    grid-template-columns: 1fr 350px;
    gap: var(--space-2xl);
    align-items: start;
  }

  .content-main h2 {
    margin: 0 0 var(--space-md);
    font-size: 28px;
    color: var(--azul);
  }

  .content-main h3 {
    margin: var(--space-xl) 0 var(--space-md);
    font-size: 22px;
    color: var(--azul);
  }

  .content-main p {
    margin: 0 0 var(--space-md);
    line-height: 1.8;
    color: var(--marron);
  }

  .highlights {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .highlights li {
    padding: var(--space-sm) 0;
    padding-left: var(--space-lg);
    position: relative;
    color: var(--marron);
    border-bottom: 1px solid var(--color-line-dark);
  }

  .highlights li::before {
    content: "‚óÜ";
    position: absolute;
    left: 0;
    color: var(--color-primary);
  }

  /* Price Card */
  .price-card {
    position: sticky;
    top: 120px;
    padding: var(--space-xl);
    background: #fff;
    border: 2px solid var(--color-primary);
    border-radius: var(--radius-xl);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
  }

  .price-header {
    text-align: center;
    margin-bottom: var(--space-lg);
  }

  .price-label {
    display: block;
    font-family: var(--font-display);
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--marron);
    margin-bottom: var(--space-xs);
  }

  .price-valor {
    display: block;
    font-family: var(--font-display);
    font-size: 42px;
    color: var(--color-primary);
  }

  .price-note {
    display: block;
    font-size: 14px;
    color: var(--marron);
    opacity: 0.7;
  }

  .price-info {
    margin: var(--space-md) 0 0;
    font-size: 13px;
    text-align: center;
    color: var(--marron);
    opacity: 0.7;
  }

  /* Itinerario */
  .itinerario {
    max-width: 700px;
    margin: var(--space-xl) auto 0;
  }

  .itinerario-item {
    display: grid;
    grid-template-columns: 80px 40px 1fr;
    gap: var(--space-sm);
    padding-bottom: var(--space-lg);
  }

  .itinerario-hora {
    font-family: var(--font-display);
    font-size: 18px;
    text-align: right;
    padding-top: 2px;
  }

  .itinerario-linea {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .itinerario-punto {
    width: 16px;
    height: 16px;
    background: var(--color-primary);
    border-radius: 50%;
    flex-shrink: 0;
  }

  .itinerario-connector {
    width: 2px;
    flex-grow: 1;
    background: var(--color-line-light);
    margin-top: var(--space-xs);
  }

  .itinerario-content h4 {
    margin: 0 0 var(--space-xs);
    font-size: 16px;
  }

  .itinerario-content p {
    margin: 0;
    font-size: 14px;
    opacity: 0.75;
  }

  /* Incluye Grid */
  .incluye-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-lg);
  }

  .incluye-card {
    padding: var(--space-xl);
    background: #fff;
    border-radius: var(--radius-xl);
    border: 1px solid var(--color-line-dark);
  }

  .incluye-card h3 {
    margin: 0 0 var(--space-md);
    font-size: 20px;
    color: var(--azul);
  }

  .incluye-card ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .incluye-card li {
    padding: var(--space-sm) 0;
    color: var(--marron);
    border-bottom: 1px solid var(--color-line-dark);
  }

  .incluye-card li:last-child {
    border-bottom: none;
  }

  /* Recomendaciones */
  .recomendaciones-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-md);
    margin-top: var(--space-xl);
  }

  .recomendacion-item {
    display: flex;
    gap: var(--space-sm);
    padding: var(--space-md);
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-md);
  }

  .recomendacion-item span {
    flex-shrink: 0;
  }

  .recomendacion-item p {
    margin: 0;
    font-size: 14px;
  }

  @media (max-width: 900px) {
    .content-layout {
      grid-template-columns: 1fr;
    }

    .price-card {
      position: static;
    }

    .incluye-grid {
      grid-template-columns: 1fr;
    }

    .recomendaciones-grid {
      grid-template-columns: 1fr;
    }

    .hero-meta {
      flex-direction: column;
      gap: var(--space-md);
    }
  }
</style>
